# React 理念

react 的变化以 v15 版本为分界线，前后差异巨大，所以就从 v15 版本开始说起。

react 在 v15 之前更新阶段分为 reconciler renderer，react 会对树形节点进行递归比对更新，整个计算过程可能因为计算量大占据主线程导致浏览器不能及时的刷新。另一点是 react 进行一项渲染更新任务的时候，如果有一个对用户来说更紧急的相应任务，此时只能等待前面的任务执行完毕之后才能响应用户，所以对应用的交互体验是一个影响。

所以为了解决 cpu 计算瓶颈以及 用户响应瓶颈，react 进行了从 16 开始到 18 才算完成的大跨度迭代。

首先为了解决 cpu 计算瓶颈需要做的是，限制大任务，留时间给浏览器进行渲染更新操作。这样的话就需要将大任务拆分为小任务，并允许中途中断将执行权交回给浏览器。这就是时间切片，react 将任务拆分为一个个小的任务，这样当一个小任务完成后就可以检查当前时间是否超过给与的时间，如果超过，退还执行权。react 将 reconciler 中对元素节点的递归操作转换为了循环，一个小任务对应着对一个节点的处理，一个时间切片初始对应着 5ms，这样一个节点处理完毕之后就可以检查是否过期需要交权。

其次是用户响应瓶颈，react 的做法是为用户设置任务的优先级，然后同样利用时间切片的检查点，实现高优先级任务对低优先任务的夺权。

这就是 react v15 之后要做到的事情。
